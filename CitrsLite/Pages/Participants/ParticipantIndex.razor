@page "/participant"
@using CitrsLite.Business.Enums;
@using CitrsLite.Business.Services;
@using CitrsLite.Business.ViewModels.ParticipantViewModels;
@using CitrsLite.Data.Models;
@inject ParticipantIndexViewModel Model;
@inject ParticipantService ParticipantService;

<MudContainer>
    <MudCard>
        <MudCardHeader>
            <MudText Typo="Typo.h2">Participant Search</MudText>
        </MudCardHeader>
        <MudCardContent>
            <EditForm Model="Model" OnValidSubmit="getParticipants">
                <MudTextField Label="Name" @bind-Value="Model.Name" />
                <MudSelect Label="Type" T="string" @bind-Values="Model.Type">
                    @foreach (var partType in Enum.GetValues(typeof(ParticipantType)))
                    {
                        <MudSelectItem Value="@partType.ToString().Replace("_", " ")" />
                    }
                </MudSelect>
                <MudTextField Label="Phone" @bind-Value="Model.Phone" />
                <MudTextField Label="City" @bind-Value="Model.City" />
            </EditForm>
        </MudCardContent>
        <MudCardActions>
            <MudButton ButtonType="ButtonType.Submit" 
                    Variant="Variant.Filled" 
                    Color="Color.Primary">
                Search
            </MudButton>
        </MudCardActions>
    </MudCard>
</MudContainer>

@code {
    private IEnumerable<Participant> participants;

    protected override void OnInitialized()
    {
        participants = new List<Participant>();
    }

    private async Task getParticipants()
    {
        participants = await ParticipantService.GetParticipantsAsync(Model);
    }

    
}
